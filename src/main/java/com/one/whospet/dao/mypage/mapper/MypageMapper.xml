<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.one.whospet.dao.mypage.face.MypageDao">
  
	<!-- 유저 DTO 제정의  -->
	<resultMap type="com.one.whospet.dto.User" id="User">
		<id column="U_No" property="uNo"/>
		
		<result column="U_GRADE" property="uGrade"/>
		<result column="U_ID" property="uId"/>
		<result column="U_PW" property="uPw"/>
		<result column="U_NAME" property="uName"/>
		<result column="U_PHONE" property="uPhone"/>
		<result column="U_NICK" property="uNick"/>
		<result column="U_EMAIL" property="uEmail"/>
		<result column="U_ADDRESS" property="uAddress"/>
		<result column="U_POST" property="uPost"/>
		<result column="U_DETAIL_ADDRESS" property="uDetailAddress"/>
		<result column="U_PET" property="uPet"/>
		<result column="U_JOIN_DATE" property="uJoinDate"/>
	</resultMap>
	
	<!-- 유저픽 DTO 제정의  -->
	<resultMap type="com.one.whospet.dto.Userpic" id="Userpic">
		<id column="UPIC_NO" property="upicNo"/>
		<result column="U_NO" property="uNo"/>
		<result column="UPIC_ORINAME" property="upicOriname"/>
		<result column="UPIC_STONAME" property="upicStoname"/>
	</resultMap>
  
  	<select id="selectUserinfo" parameterType="com.one.whospet.dto.User" resultMap="User">
	SELECT * FROM W_USER WHERE U_No = #{uNo }
	</select>
	
	<insert id="insertFile" parameterType="com.one.whospet.dto.User">
		
	<selectKey order="BEFORE" resultType="int" keyProperty="upicNo">
			SELECT w_user_pic_seq.nextval FROM dual
	</selectKey>
		
		INSERT INTO w_user_pic ( upic_no, u_no, upic_oriname, upic_stoname )
		VALUES ( #{upicNo }, #{uNo }, #{upicOriname }, #{upicStoname } )
	</insert>
	
	<select id="selectPicByUNo" parameterType="com.one.whospet.dto.User" resultMap="Userpic">
	SELECT * FROM W_USER_PIC WHERE U_No = #{uNo }
	</select>
	
	<delete id="deleteUserPic" parameterType="com.one.whospet.dto.User">
		DELETE FROM w_user_pic
		WHERE U_No = #{uNo }
	</delete>
	
	<update id="updateUser">
		UPDATE w_user SET u_pw = #{uPw }, u_nick = #{uNick }, u_phone = #{uPhone }, u_email = #{uEmail }, u_address = #{uAddress }  WHERE u_no = #{uNo }
	</update>
	
	<select id="selectUserCnt" parameterType="com.one.whospet.dto.User" resultType="int">
		SELECT COUNT(*) FROM w_user WHERE u_no = #{uNo } and u_pw = #{uPw }
	</select>
	
	<delete id="deleteUser" parameterType="com.one.whospet.dto.User">
		DELETE FROM w_user WHERE U_No = #{uNo }
	</delete>
  </mapper>